<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>쪽지 목록</title>
</head>
<body>
<h1>받은 쪽지 목록</h1>

<div th:if="${#lists.isEmpty(messages)}">
    <form method="post" th:action="@{/message/delete}">
        <table border="1">
            <button type="submit">삭제</button>
            <thead>
            <tr>
                <th>
                    <input type="checkbox" id="select" onclick="toggleSelectAll()" />
                </th>
                <th>번호</th>
                <th>보낸사람</th>
                <th>제목</th>
                <!--                <th>내용</th>-->
                <th>날짜</th>
                <th>읽음 여부</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="message, iterStat : ${messages}">
                <td>
                    <input type="checkbox" name="messageIds" th:value="${message.id}" class="messageCheckbox"/>
                </td>
                <td><a th:href="@{/message/view?messageId={id}(id=${message.id})}" th:text="${iterStat.index + 1}"></a></td>
                <td th:text="${message.senderId}"></td>
                <td th:text="${message.title}"></td>
                <!--                <td th:text="${message.content}"></td>-->
                <!--                <td th:text="${message.regDate}"></td>-->
                <td th:text="${#temporals.format(message.regDate, 'yyyy-MM-dd HH:mm')}"></td>

                <td th:text="${message.isRead ? '읽음' : '안 읽음'}"></td>
            </tr>
            </tbody>
        </table>
    </form>
    <p>쪽지가 없습니다.</p>
</div>

<div th:unless="${#lists.isEmpty(messages)}">
    <form method="post" th:action="@{/message/delete}">
        <table border="1">
            <thead>
            <tr>
                <th>
                    <input type="checkbox" id="selectAll" onclick="toggleSelectAll()" />
                </th>
                <th>번호</th>
                <th>보낸사람</th>
                <th>제목</th>
<!--                <th>내용</th>-->
                <th>날짜</th>
                <th>읽음 여부</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="message, iterStat : ${messages}">
                <td>
                    <input type="checkbox" name="messageIds" th:value="${message.id}" class="messageCheckbox"/>
                </td>
                <td><a th:href="@{/message/view?messageId={id}(id=${message.id})}" th:text="${iterStat.index + 1}"></a></td>
                <td th:text="${message.senderId}"></td>
                <td th:text="${message.title}"></td>
<!--                <td th:text="${message.content}"></td>-->
<!--                <td th:text="${message.regDate}"></td>-->
                <td th:text="${#temporals.format(message.regDate, 'yyyy-MM-dd HH:mm')}"></td>

                <td th:text="${message.isRead ? '읽음' : '안 읽음'}"></td>
            </tr>
            </tbody>
        </table>

        <button type="submit">삭제</button>
    </form>
</div>
<button type="button" onclick="window.location.href='/message/send/list';">보낸쪽지목록</button>

<a href="/message/regist" style="display:block; margin-top: 20px;">
    <button>쪽지 쓰기</button>
</a>

<script>
    function toggleSelectAll() {
        const selectAllCheckbox = document.getElementById('selectAll');
        const checkboxes = document.querySelectorAll('.messageCheckbox');

        // 전체 선택/해제 처리
        checkboxes.forEach(checkbox => {
            checkbox.checked = selectAllCheckbox.checked;
        });
    }
</script>
</body>
</html>